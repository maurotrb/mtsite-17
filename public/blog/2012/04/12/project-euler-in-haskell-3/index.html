<!DOCTYPE html>
<html class="has-navbar-fixed-top" lang="en">
  <head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23038857-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-23038857-1', { 'anonymize_ip': true });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Project Euler in Haskell #3</title>
    <meta name="description" content="Mauro Taraborelli&#39;s Personal Site and Blog">
    <meta name="author" content="Mauro Taraborelli">

    <link rel="stylesheet" href="https://www.maurotaraborelli.com/css/mtsite.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    
    <meta name="generator" content="Hugo 0.30.2" />
  </head>
  <body>
    <header id="site-navbar">
      <nav class="navbar is-fixed-top container">
        <div class="navbar-brand">
          <a class="navbar-item" id="logo" href="">Mauro Taraborelli</a>
          <button class="button navbar-burger" data-target="navMenu">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div class="navbar-menu" id="navMenu">
          <div class="navbar-start">
	    
	    <a class="navbar-item" href="/blog/">BLOG</a>
            
	    <a class="navbar-item" href="/projects/">PROJECTS</a>
            
	    <a class="navbar-item" href="/resume/">RESUME</a>
            
          </div>

          <div class="navbar-end">
            <a class="navbar-item" href="https://www.linkedin.com/in/maurotaraborelli">
              <span class="icon">
                <i class="fa fa-lg fa-linkedin"></i>
              </span>
            </a>
            <a class="navbar-item" href="https://github.com/maurotrb">
              <span class="icon">
                <i class="fa fa-lg fa-github"></i>
              </span>
            </a>
            <div class="navbar-item buttons has-addons">
              
              
              
              
              
              
              <a class="button is-primary is-outlined" href="/it">
                <span class="icon is-small">
                  <i class="fa fa-exchange"></i>
                </span>
                <span>Italiano</span>
                <span class="icon is-small">
                  <i class="fa fa-globe"></i>
                </span>
              </a>
              
              
            </div>
          </div>
        </div>
      </nav>
    </header>
    
<div class="container">
  <div class="columns">
    <div class="column is-four-fifths">
      <main class="section">
        <header>
          <h1 class="title is-2">Project Euler in Haskell #3</h1>
          <p class="subtitle is-5">
            2012-04-12 â€” Article of 800 words
            
            

<a class="tag is-rounded" href="https://www.maurotaraborelli.com/tags/programming">Programming</a>

<a class="tag is-rounded" href="https://www.maurotaraborelli.com/tags/haskell">Haskell</a>

<a class="tag is-rounded" href="https://www.maurotaraborelli.com/tags/project-euler">Project Euler</a>



          </p>
        </header>
        <section class="section">
          <div class="content">
            <h2 id="problem-description">Problem Description</h2>

<p><a href="http://projecteuler.net/problem=3">Link to Project Euler problem 3</a></p>

<p>The prime factors of 13195 are 5, 7, 13 and 29.</p>

<p>What is the largest prime factor of the number 600851475143?</p>

<p><strong>WARNING</strong>
<em>Solution ahead. Don&rsquo;t read more if you want to enjoy the benefits of
Project Euler and you haven&rsquo;t already solved the problem.</em></p>

<p></p>

<h2 id="solution">Solution</h2>

<p>We need a primes generator to find the prime factors of a number.
Instead of using a package from Hackage, I prefer to create a
generator from scratch.</p>

<p>I will use the sieve of Eratosthenes algorithm, as described by
<a href="http://www.cs.hmc.edu/~oneill/papers/Sieve-JFP.pdf">Melissa E. O&rsquo;Neill (PDF 217KB)</a>.</p>

<p>The generator proposed in the article use a priority queue data structure.
A simple and effective priority queue, the <code>Pairing Heap</code>, is described
by <a href="http://themonadreader.files.wordpress.com/2010/05/issue16.pdf">Louis Wasserman (PDF 396KB)</a>.</p>

<p>Here is the code, adapted to the need of the sieve algorithm, and without
using the <code>Maybe</code> monad for min value extraction (for simplicity&rsquo;s sake).</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>  <span style="color:#f92672">=</span>  <span style="color:#66d9ef">Empty</span>
                    <span style="color:#f92672">|</span>  <span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">a</span> [<span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>]
                       <span style="color:#66d9ef">deriving</span> (<span style="color:#66d9ef">Show</span>)

(<span style="color:#f92672">+++</span>)              <span style="color:#f92672">::</span> <span style="color:#66d9ef">Ord</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#66d9ef">Empty</span>  <span style="color:#f92672">+++</span>  <span style="color:#a6e22e">heap</span>   <span style="color:#f92672">=</span>  <span style="color:#a6e22e">heap</span>
<span style="color:#a6e22e">heap</span>   <span style="color:#f92672">+++</span>  <span style="color:#66d9ef">Empty</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">heap</span>
<span style="color:#a6e22e">heap1</span><span style="color:#f92672">@</span>(<span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x1</span> <span style="color:#a6e22e">ts1</span>)  <span style="color:#f92672">+++</span>  <span style="color:#a6e22e">heap2</span><span style="color:#f92672">@</span>(<span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x2</span> <span style="color:#a6e22e">ts2</span>)
    <span style="color:#f92672">|</span> <span style="color:#a6e22e">x1</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x2</span>     <span style="color:#f92672">=</span>  <span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x1</span> (<span style="color:#a6e22e">heap2</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ts1</span>)
    <span style="color:#f92672">|</span> <span style="color:#a6e22e">otherwise</span>    <span style="color:#f92672">=</span>  <span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x2</span> (<span style="color:#a6e22e">heap1</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ts2</span>)

<span style="color:#75715e">-- Construction</span>
<span style="color:#a6e22e">empty</span>  <span style="color:#f92672">::</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">empty</span>  <span style="color:#f92672">=</span>  <span style="color:#66d9ef">Empty</span>

<span style="color:#a6e22e">singleton</span>    <span style="color:#f92672">::</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">singleton</span> <span style="color:#a6e22e">x</span>  <span style="color:#f92672">=</span>  <span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">[]</span>

<span style="color:#75715e">-- Insertion</span>
<span style="color:#a6e22e">insert</span>      <span style="color:#f92672">::</span> <span style="color:#66d9ef">Ord</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">insert</span> <span style="color:#a6e22e">x</span> <span style="color:#a6e22e">q</span>  <span style="color:#f92672">=</span>  (<span style="color:#a6e22e">singleton</span> <span style="color:#a6e22e">x</span>) <span style="color:#f92672">+++</span> <span style="color:#a6e22e">q</span>

<span style="color:#75715e">-- Priority Queue</span>
<span style="color:#a6e22e">minValue</span>                 <span style="color:#f92672">::</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span>  <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">minValue</span> <span style="color:#66d9ef">Empty</span>           <span style="color:#f92672">=</span>  <span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;Empty queue!&#34;</span>
<span style="color:#a6e22e">minValue</span> (<span style="color:#66d9ef">PairNode</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">_</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">x</span>

<span style="color:#a6e22e">deleteMin</span>                  <span style="color:#f92672">::</span> <span style="color:#66d9ef">Ord</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">deleteMin</span> <span style="color:#66d9ef">Empty</span>            <span style="color:#f92672">=</span>  <span style="color:#a6e22e">error</span> <span style="color:#e6db74">&#34;Empty queue!&#34;</span>
<span style="color:#a6e22e">deleteMin</span> (<span style="color:#66d9ef">PairNode</span> <span style="color:#66d9ef">_</span> <span style="color:#a6e22e">ts</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">meldChildren</span> <span style="color:#a6e22e">ts</span>
    <span style="color:#66d9ef">where</span>
      <span style="color:#a6e22e">meldChildren</span> (<span style="color:#a6e22e">t1</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">t2</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ts</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">t1</span> <span style="color:#f92672">+++</span> <span style="color:#a6e22e">t2</span> <span style="color:#f92672">+++</span> <span style="color:#a6e22e">meldChildren</span> <span style="color:#a6e22e">ts</span>
      <span style="color:#a6e22e">meldChildren</span> [<span style="color:#a6e22e">t</span>]         <span style="color:#f92672">=</span>  <span style="color:#a6e22e">t</span>
      <span style="color:#a6e22e">meldChildren</span> <span style="color:#66d9ef">[]</span>          <span style="color:#f92672">=</span>  <span style="color:#66d9ef">Empty</span>

<span style="color:#a6e22e">deleteMinAndInsert</span>      <span style="color:#f92672">::</span> <span style="color:#66d9ef">Ord</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#a6e22e">a</span>
<span style="color:#a6e22e">deleteMinAndInsert</span> <span style="color:#a6e22e">x</span> <span style="color:#a6e22e">q</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">insert</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">$</span> <span style="color:#a6e22e">deleteMin</span> <span style="color:#a6e22e">q</span></code></pre></div>

<p>This <code>Pairing Heap</code> implementation doesn&rsquo;t support a key/value node.
So I define an <code>Iterator</code> data type to manage the key/value concept
necessary to the algorithm.</p>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#75715e">-- Iterator</span>
<span style="color:#66d9ef">data</span> <span style="color:#66d9ef">Iterator</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">Iterator</span> <span style="color:#66d9ef">Integer</span> [<span style="color:#66d9ef">Integer</span>]
    <span style="color:#66d9ef">deriving</span> (<span style="color:#66d9ef">Show</span>)

<span style="color:#66d9ef">instance</span> <span style="color:#66d9ef">Eq</span> <span style="color:#66d9ef">Iterator</span> <span style="color:#66d9ef">where</span>
    (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">_</span>) <span style="color:#f92672">==</span> (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">y</span> <span style="color:#66d9ef">_</span>) <span style="color:#f92672">=</span> <span style="color:#a6e22e">x</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">y</span>

<span style="color:#66d9ef">instance</span> <span style="color:#66d9ef">Ord</span> <span style="color:#66d9ef">Iterator</span> <span style="color:#66d9ef">where</span>
    <span style="color:#a6e22e">compare</span> (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">_</span>) (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">y</span> <span style="color:#66d9ef">_</span>) <span style="color:#f92672">=</span> <span style="color:#a6e22e">compare</span> <span style="color:#a6e22e">x</span> <span style="color:#a6e22e">y</span></code></pre></div></p>

<p>I even create a <code>Table</code> type alias and some utility functions to hide
the priority queue specific implementation from the algorithm.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#75715e">-- Table</span>
<span style="color:#66d9ef">type</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">PairingHeap</span> <span style="color:#66d9ef">Iterator</span>

<span style="color:#a6e22e">emptyTable</span>  <span style="color:#f92672">::</span> <span style="color:#66d9ef">Table</span>
<span style="color:#a6e22e">emptyTable</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">empty</span>

<span style="color:#a6e22e">insertTable</span>         <span style="color:#f92672">::</span> <span style="color:#66d9ef">Integer</span> <span style="color:#f92672">-&gt;</span> [<span style="color:#66d9ef">Integer</span>] <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Table</span>
<span style="color:#a6e22e">insertTable</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">t</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">insert</span> (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">is</span>) <span style="color:#a6e22e">t</span>

<span style="color:#a6e22e">tableMinValue</span>    <span style="color:#f92672">::</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Integer</span>
<span style="color:#a6e22e">tableMinValue</span> <span style="color:#a6e22e">t</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">n</span>
    <span style="color:#66d9ef">where</span>
      (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">_</span>) <span style="color:#f92672">=</span> <span style="color:#a6e22e">minValue</span> <span style="color:#a6e22e">t</span>

<span style="color:#a6e22e">tableMinValueIters</span>    <span style="color:#f92672">::</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">-&gt;</span> (<span style="color:#66d9ef">Integer</span>, [<span style="color:#66d9ef">Integer</span>])
<span style="color:#a6e22e">tableMinValueIters</span> <span style="color:#a6e22e">t</span>  <span style="color:#f92672">=</span>  (<span style="color:#a6e22e">n</span>, <span style="color:#a6e22e">is</span>)
    <span style="color:#66d9ef">where</span>
      (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">is</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">minValue</span> <span style="color:#a6e22e">t</span>

<span style="color:#a6e22e">tableDeleteMinAndInsert</span>         <span style="color:#f92672">::</span> <span style="color:#66d9ef">Integer</span> <span style="color:#f92672">-&gt;</span> [<span style="color:#66d9ef">Integer</span>] <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Table</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Table</span>
<span style="color:#a6e22e">tableDeleteMinAndInsert</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">t</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">deleteMinAndInsert</span> (<span style="color:#66d9ef">Iterator</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">is</span>) <span style="color:#a6e22e">t</span></code></pre></div>

<p>With the priority queue completed, we can define the sieve algorithm:</p>

<ul>
<li>the <code>sieve</code> function filters the input sequence and find the primes incrementally</li>
<li>the <code>wheel</code> stream and the <code>spin</code> function allow to generate an input sequence
without the composites of the primes 2,3,5,7; this optimization makes the sieve seven
times faster than with a complete input sequence <code>[2..]</code></li>
<li>the <code>primes</code> stream is created composing the sieve and the spinned wheel</li>
</ul>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#a6e22e">sieve</span>         <span style="color:#f92672">::</span> [<span style="color:#66d9ef">Integer</span>] <span style="color:#f92672">-&gt;</span> [<span style="color:#66d9ef">Integer</span>]
<span style="color:#a6e22e">sieve</span> <span style="color:#66d9ef">[]</span>      <span style="color:#f92672">=</span>  <span style="color:#66d9ef">[]</span>
<span style="color:#a6e22e">sieve</span> (<span style="color:#a6e22e">x</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">xs</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">:</span> <span style="color:#a6e22e">sieve&#39;</span> <span style="color:#a6e22e">xs</span> (<span style="color:#a6e22e">insertprime</span> <span style="color:#a6e22e">x</span> <span style="color:#a6e22e">xs</span> <span style="color:#a6e22e">emptyTable</span>)
    <span style="color:#66d9ef">where</span>
      <span style="color:#a6e22e">insertprime</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">xs</span> <span style="color:#a6e22e">table</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">insertTable</span> (<span style="color:#a6e22e">p</span><span style="color:#f92672">*</span><span style="color:#a6e22e">p</span>) (<span style="color:#a6e22e">map</span> (<span style="color:#f92672">*</span><span style="color:#a6e22e">p</span>) <span style="color:#a6e22e">xs</span>) <span style="color:#a6e22e">table</span>
      <span style="color:#a6e22e">sieve&#39;</span> <span style="color:#66d9ef">[]</span> <span style="color:#a6e22e">table</span>  <span style="color:#f92672">=</span>  <span style="color:#66d9ef">[]</span>
      <span style="color:#a6e22e">sieve&#39;</span> (<span style="color:#a6e22e">x</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">xs</span>) <span style="color:#a6e22e">table</span>
          <span style="color:#f92672">|</span> <span style="color:#a6e22e">nextComposite</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">sieve&#39;</span> <span style="color:#a6e22e">xs</span> (<span style="color:#a6e22e">adjust</span> <span style="color:#a6e22e">table</span>)
          <span style="color:#f92672">|</span> <span style="color:#a6e22e">otherwise</span>           <span style="color:#f92672">=</span>  <span style="color:#a6e22e">x</span> <span style="color:#66d9ef">:</span> <span style="color:#a6e22e">sieve&#39;</span> <span style="color:#a6e22e">xs</span> (<span style="color:#a6e22e">insertprime</span> <span style="color:#a6e22e">x</span> <span style="color:#a6e22e">xs</span> <span style="color:#a6e22e">table</span>)
          <span style="color:#66d9ef">where</span>
            <span style="color:#a6e22e">nextComposite</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">tableMinValue</span> <span style="color:#a6e22e">table</span>
            <span style="color:#a6e22e">adjust</span> <span style="color:#a6e22e">table</span>
                <span style="color:#f92672">|</span> <span style="color:#a6e22e">n</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">x</span>     <span style="color:#f92672">=</span>  <span style="color:#a6e22e">adjust</span> (<span style="color:#a6e22e">tableDeleteMinAndInsert</span> <span style="color:#a6e22e">n&#39;</span> <span style="color:#a6e22e">ns</span> <span style="color:#a6e22e">table</span>)
                <span style="color:#f92672">|</span> <span style="color:#a6e22e">otherwise</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">table</span>
                <span style="color:#66d9ef">where</span>
                  (<span style="color:#a6e22e">n</span>, <span style="color:#a6e22e">n&#39;</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ns</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">tableMinValueIters</span> <span style="color:#a6e22e">table</span>

<span style="color:#a6e22e">wheel2357</span> <span style="color:#f92672">::</span> [<span style="color:#66d9ef">Integer</span>]
<span style="color:#a6e22e">wheel2357</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">8</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span>
            <span style="color:#66d9ef">:</span><span style="color:#ae81ff">8</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">6</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">4</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">10</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">10</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">wheel2357</span>

<span style="color:#a6e22e">spin</span>           <span style="color:#f92672">::</span> [<span style="color:#66d9ef">Integer</span>] <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">Integer</span> <span style="color:#f92672">-&gt;</span> [<span style="color:#66d9ef">Integer</span>]
<span style="color:#a6e22e">spin</span> (<span style="color:#a6e22e">x</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">xs</span>) <span style="color:#a6e22e">n</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">n</span> <span style="color:#66d9ef">:</span> <span style="color:#a6e22e">spin</span> <span style="color:#a6e22e">xs</span> (<span style="color:#a6e22e">n</span><span style="color:#f92672">+</span><span style="color:#a6e22e">x</span>)

<span style="color:#a6e22e">primes</span>  <span style="color:#f92672">::</span> [<span style="color:#66d9ef">Integer</span>]
<span style="color:#a6e22e">primes</span>  <span style="color:#f92672">=</span>  <span style="color:#ae81ff">2</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">3</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">5</span><span style="color:#66d9ef">:</span><span style="color:#ae81ff">7</span><span style="color:#66d9ef">:</span> <span style="color:#a6e22e">sieve</span> (<span style="color:#a6e22e">spin</span> <span style="color:#a6e22e">wheel2357</span> <span style="color:#ae81ff">11</span>)</code></pre></div></p>

<p>I use the primes generator to find the prime factors of an integer.</p>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#a6e22e">primeFactors</span>    <span style="color:#f92672">::</span> <span style="color:#66d9ef">Integer</span> <span style="color:#f92672">-&gt;</span> [<span style="color:#66d9ef">Integer</span>]
<span style="color:#a6e22e">primeFactors</span> <span style="color:#a6e22e">n</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">factors</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">primes</span>
    <span style="color:#66d9ef">where</span>
      <span style="color:#a6e22e">factors</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">_</span>                   <span style="color:#f92672">=</span>  <span style="color:#66d9ef">[]</span>
      <span style="color:#a6e22e">factors</span> <span style="color:#a6e22e">m</span> (<span style="color:#a6e22e">p</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ps</span>) <span style="color:#f92672">|</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">p</span><span style="color:#f92672">*</span><span style="color:#a6e22e">p</span>    <span style="color:#f92672">=</span>  [<span style="color:#a6e22e">m</span>]
                       <span style="color:#f92672">|</span> <span style="color:#a6e22e">r</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>     <span style="color:#f92672">=</span>  <span style="color:#a6e22e">p</span> <span style="color:#66d9ef">:</span> <span style="color:#a6e22e">factors</span> <span style="color:#a6e22e">q</span> (<span style="color:#a6e22e">p</span><span style="color:#66d9ef">:</span><span style="color:#a6e22e">ps</span>)
                       <span style="color:#f92672">|</span> <span style="color:#a6e22e">otherwise</span>  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">factors</span> <span style="color:#a6e22e">m</span> <span style="color:#a6e22e">ps</span>
                       <span style="color:#66d9ef">where</span> (<span style="color:#a6e22e">q</span>,<span style="color:#a6e22e">r</span>)  <span style="color:#f92672">=</span>  <span style="color:#a6e22e">quotRem</span> <span style="color:#a6e22e">m</span> <span style="color:#a6e22e">p</span></code></pre></div></p>

<p>And, finally, the solution:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#a6e22e">solution</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">last</span> <span style="color:#f92672">$</span> <span style="color:#a6e22e">primeFactors</span> <span style="color:#ae81ff">600851475143</span></code></pre></div>

<p>You can find the Literate Haskell code on <a href="https://github.com/maurotrb/mt-euler">GitHub</a>
and on <a href="https://bitbucket.org/maurotrb/mt-euler">Bitbucket</a>.</p>
          </div>
        </section>
      </main>
      
<aside class="section">
  <div class="level box">
    <div class="level-left">
      
      <p class="level-item">
        <a href="https://www.maurotaraborelli.com/blog/2012/04/20/project-euler-in-haskell-4/">
          <span class="icon is-small">
            <i class="fa fa-arrow-left"></i>
          </span>
          <span>Project Euler in Haskell #4</span>
        </a>
      </p>
      
    </div>
    <div class="level-left">
      
      <p class="level-item">
        <a href="https://www.maurotaraborelli.com/blog/2012/04/11/institutions-will-try-to-preserve-the-problem/">
          <span>Institutions will try to preserve the problem...</span>
          <span class="icon is-small">
            <i class="fa fa-arrow-right"></i>
          </span>
        </a>
      </p>
      
    </div>
  </div>
</aside>

    </div>
    <div class="column">
      <aside id="sidebar">
        <section class="section">
  <div class="level">
    <div class="level-item">
      <figure class="image is-128x128 round-portrait">
        <img src="/img/mauro-taraborelli-portrait-256.jpg" alt="Mauro Taraborelli Portrait">
      </figure>
    </div>
  </div>
  <div class="level">
    <div class="level-item">
      <div class="content">
        I&rsquo;m <strong>Mauro Taraborelli</strong>, an IT Business Analyst and Project Manager, from Italy. Contact me by <a href="mail:mauro@maurotaraborelli.com">email</a>.
      </div>
    </div>
  </div>
</section>

        <section class="section" id="tags">
  <h1 class="title is-6">Explore this site</h1>
  <div class="tags">
    
    <a class="tag is-info is-rounded" href="/tags/programming">Programming (17)</a>
    
    <a class="tag is-info is-rounded" href="/tags/haskell">Haskell (10)</a>
    
    <a class="tag is-info is-rounded" href="/tags/quote">Quote (10)</a>
    
    <a class="tag is-info is-rounded" href="/tags/coursera">Coursera (6)</a>
    
    <a class="tag is-info is-rounded" href="/tags/mooc">MOOC (6)</a>
    
    <a class="tag is-info is-rounded" href="/tags/data-science">Data Science (5)</a>
    
    <a class="tag is-info is-rounded" href="/tags/project-euler">Project Euler (5)</a>
    
    <a class="tag is-info is-rounded" href="/tags/r">R (5)</a>
    
    <a class="tag is-info is-rounded" href="/tags/business">Business (4)</a>
    
    <a class="tag is-info is-rounded" href="/tags/photography">Photography (4)</a>
    
    <a class="tag is-info is-rounded" href="/tags/ruby">Ruby (3)</a>
    
    <a class="tag is-info is-rounded" href="/tags/foundation">Foundation (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/hakyll">Hakyll (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/learning">Learning (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/rake">Rake (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/web">Web (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/writing">Writing (2)</a>
    
    <a class="tag is-info is-rounded" href="/tags/backup">Backup (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/git">Git (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/imagemagick">Imagemagick (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/jazz">Jazz (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/latex">LaTeX (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/mocc">MOCC (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/management">Management (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/music">Music (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/octopress">Octopress (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/robocopy">Robocopy (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/truecrypt">TrueCrypt (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/unison">Unison (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/xetex">XeTeX (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/edx">edX (1)</a>
    
    <a class="tag is-info is-rounded" href="/tags/mr">mr (1)</a>
    
    
  </div>
</section>

      </aside>
    </div>
  </div>
</div>

    <footer class="footer" id="site-footer">
      <div class="container">
        <div class="columns">
          <div class="column">
            <div class="content has-text-centered is-small">
              <p>Code examples licensed <a href="http://opensource.org/licenses/mit-license.php">MIT</a>.</p>
              <p>Content licensed <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.</p>
              <p>Source available at <a href="https://github.com/maurotrb/mtsite-17">GitHub</a></p>
            </div>
          </div>
          <div class="column">
            <div class="content has-text-centered">
              <p>Mauro Taraborelli&#39;s Personal Site and Blog</p>
              <p>
                <a href="https://www.linkedin.com/in/maurotaraborelli">
                  <span class="icon">
                    <i class="fa fa-lg fa-linkedin"></i>
                  </span>
                </a>
                <a href="https://github.com/maurotrb">
                  <span class="icon">
                    <i class="fa fa-lg fa-github"></i>
                  </span>
                </a>
              </p>
            </div>
          </div>
          <div class="column">
            <div class="content has-text-centered is-small">
              <p>Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://bulma.io">Bulma</a></p>
              <p><a href="//www.iubenda.com/privacy-policy/8268024" class="iubenda-white iubenda-embed" title="Privacy Policy">Privacy Policy</a><script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src = "//cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_SVG"></script>
    <script src="/js/mtsite.js"></script>
  </body>
</html>
